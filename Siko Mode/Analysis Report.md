# Basic Analysis
With floss, I found those paths:
@C:\\Users\\Public\\passwrd.txt
Desktop\\cosmo.jpeg
Found this url: http://cdn.altimiter.local/feed?post=
![[Pasted image 20231025213513.png]]
### Hashes:
Sha256: 3aca2a08cf296f1845d6171958ef0ffd1c8bdfc3e48bdd34a605cb1f7468213e
MD5: b9497ffb7e9c6f49823b95851ec874e3
### Language of the binary:
Nim, from floss output: Nim httpclient/1.6.2
### Â Architecture of the binary:
x64, see assembly (64 bits registers used)
### Persistence:
No persistence.
### PEStudio:
The PE doesn't seem to be obfuscated because we can see strings and library imports, it has those imports:
![[Pasted image 20231025211227.png]]
We also have some sus Windows API calls that are sus, we can see more of this in the advanced analysis phase.
![[Pasted image 20240319012233.png]]
### Strings:
The url we found seems like exfiltration domain, the post parameter holds the data exfiltrated (here the exfiltrated data is cosmo.jpeg)
![[Pasted image 20231025205916.png]]
![[Pasted image 20231025210320.png]]
![[Pasted image 20240124234341.png]]
I also found those things, they seem sus.
![[Pasted image 20231025210732.png]]

### Procmon
- If there is no internet access: the executable deletes itself.
- Same thing if there is an internet access, plus it creates a file in C:\\Users\\Public\\ called passwrd.txt used to \encrypt the cosmo.jpeg file using RC4
Also, there is so much TCP traffic, this traffic is the exfiltration process to the exfiltration server:
![[Pasted image 20240319012815.png]]
### Wireshark
First it attempts to reach this url:
![[Pasted image 20240319163706.png]]
The attempt succeeded so the exfiltration phase will start, it first sends a DNS request to get the ip address of the exfiltration domain:
![[Pasted image 20240124234717.png]]
The exfiltration starts:
![[Pasted image 20240124235500.png]]
# Advanced Analysis
First we should find the entry point, after looking at all the functions that have main in their name we find:
![[Pasted image 20240319013519.png]]
which holds the real working process of the malware.
Here we can see the jne instruction that if fails it calls the houdini fnct:
![[Pasted image 20240319013936.png]]
This houdini function is called another time if the second jne doesnt fail, but it fails, it calls 3 interesting functions: unpackResources, stealStuff and popSafePoint, and then in any cases it calls houdini. Seeing the similarities between the code and after seeing how the program works, we can understand that:
- The first part of the code starts by checking the directory for Cosmo.jpeg, if it doesnt find it/it fails, it calls houdini (which is deleting itself)
- Then it seems to check if there is an internet connection by trying to reach the domain above (DNS), if it fails it deletes itself (houdini) 
- If it reaches it, it calls the unpackResources function that seems to create the passwrd.txt file that is used for the RC4 exncryption, and then it starts the exfiltration process (stealStuff)
- When the exfiltration ends, it calls nimLeaveFinally and also it deletes itself.
![[Pasted image 20240319014038.png]]