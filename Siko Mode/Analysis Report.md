# Basic Analysis
With floss, I found those paths:
@C:\\Users\\Public\\passwrd.txt
Desktop\\cosmo.jpeg
Found this url: http://cdn.altimiter.local/feed?post=
![alt text](https://github.com/kw4ntuum/malware_analysis/blob/main/Siko%20Mode/Images/Pasted%20image%2020231025213513.png?raw=true)
### Hashes:
Sha256: 3aca2a08cf296f1845d6171958ef0ffd1c8bdfc3e48bdd34a605cb1f7468213e
MD5: b9497ffb7e9c6f49823b95851ec874e3
### Language of the binary:
Nim, from floss output: Nim httpclient/1.6.2
### Â Architecture of the binary:
x64, see assembly (64 bits registers used)
### Persistence:
No persistence.
### PEStudio:
The PE doesn't seem to be obfuscated because we can see strings and library imports, it has those imports:
![alt text](https://github.com/kw4ntuum/malware_analysis/blob/main/Siko%20Mode/Images/Paste%20image%2020231025211227.png?raw=true)
We also have some sus Windows API calls that are sus, we can see more of this in the advanced analysis phase.
![alt text](https://github.com/kw4ntuum/malware_analysis/blob/main/Siko%20Mode/Images/Paste%20image%2020240319012233.png?raw=true)
### Strings:
The url we found seems like exfiltration domain, the post parameter holds the data exfiltrated (here the exfiltrated data is cosmo.jpeg)
![alt text](https://github.com/kw4ntuum/malware_analysis/blob/main/Siko%20Mode/Images/Paste%20image%2020231025205916.png?raw=true)
![alt text](https://github.com/kw4ntuum/malware_analysis/blob/main/Siko%20Mode/Images/Paste%20image%2020231025210320.png?raw=true)
![alt text](https://github.com/kw4ntuum/malware_analysis/blob/main/Siko%20Mode/Images/Paste%20image%2020240124234341.png?raw=true)
I also found those things, they seem sus.
![alt text](https://github.com/kw4ntuum/malware_analysis/blob/main/Siko%20Mode/Images/Paste%20image%2020231025210732.png?raw=true)

### Procmon
- If there is no internet access: the executable deletes itself.
- Same thing if there is an internet access, plus it creates a file in C:\\Users\\Public\\ called passwrd.txt used to \encrypt the cosmo.jpeg file using RC4
Also, there is so much TCP traffic, this traffic is the exfiltration process to the exfiltration server:
![alt text](https://github.com/kw4ntuum/malware_analysis/blob/main/Siko%20Mode/Images/Paste%20image%2020240319012815.png?raw=true)
### Wireshark
First it attempts to reach this url:
![alt text](https://github.com/kw4ntuum/malware_analysis/blob/main/Siko%20Mode/Images/Paste%20image%2020240319163706.png?raw=true)
The attempt succeeded so the exfiltration phase will start, it first sends a DNS request to get the ip address of the exfiltration domain:
![alt text](https://github.com/kw4ntuum/malware_analysis/blob/main/Siko%20Mode/Images/Paste%20image%2020240124234717.png?raw=true)
The exfiltration starts:
![alt text](https://github.com/kw4ntuum/malware_analysis/blob/main/Siko%20Mode/Images/Paste%20image%2020240124235500.png?raw=true)
# Advanced Analysis
First we should find the entry point, after looking at all the functions that have main in their name we find:
![alt text](https://github.com/kw4ntuum/malware_analysis/blob/main/Siko%20Mode/Images/Paste%20image%2020240319013519.png?raw=true)
which holds the real working process of the malware.
Here we can see the jne instruction that if fails it calls the houdini fnct:
![alt text](https://github.com/kw4ntuum/malware_analysis/blob/main/Siko%20Mode/Images/Paste%20image%2020240319013936.png?raw=true)
This houdini function is called another time if the second jne doesnt fail, but it fails, it calls 3 interesting functions: unpackResources, stealStuff and popSafePoint, and then in any cases it calls houdini. Seeing the similarities between the code and after seeing how the program works, we can understand that:
- The first part of the code starts by checking the directory for Cosmo.jpeg, if it doesnt find it/it fails, it calls houdini (which is deleting itself)
- Then it seems to check if there is an internet connection by trying to reach the domain above (DNS), if it fails it deletes itself (houdini) 
- If it reaches it, it calls the unpackResources function that seems to create the passwrd.txt file that is used for the RC4 exncryption, and then it starts the exfiltration process (stealStuff)
- When the exfiltration ends, it calls nimLeaveFinally and also it deletes itself.
![alt text](https://github.com/kw4ntuum/malware_analysis/blob/main/Siko%20Mode/Images/Paste%20image%2020240319014038.png?raw=true)
